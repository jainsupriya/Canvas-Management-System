{"ast":null,"code":"import _toConsumableArray from \"/Users/supriyajain/Desktop/273/canvas/Lab1 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/supriyajain/Desktop/273/canvas/Lab1 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/supriyajain/Desktop/273/canvas/Lab1 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/supriyajain/Desktop/273/canvas/Lab1 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/supriyajain/Desktop/273/canvas/Lab1 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/supriyajain/Desktop/273/canvas/Lab1 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/supriyajain/Desktop/273/canvas/Lab1 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/supriyajain/Desktop/273/canvas/Lab1 - 013767416/canvas/frontend/src/components/CourseDetails/Files/Files.js\";\nimport React, { Component } from 'react';\nimport \"react-web-tabs/dist/react-web-tabs.css\";\nimport FormData from 'form-data';\nimport { FaTrash } from \"react-icons/fa\";\nimport Grid from '@material-ui/core/Grid';\nimport MiniDrawer from '../../Layout/MiniDrawer';\nimport Sidebar from '../../Layout/Sidebar';\nimport Appbar from '../../Layout/Appbar';\nimport MenuList from '../../Layout/MenuList';\nimport { Container, Row, Col } from 'reactstrap';\nimport Search from '../../Search';\nimport Moment from 'react-moment';\nimport cookie from 'react-cookies';\nimport { Redirect } from 'react-router';\nimport LongMenu from '../../Layout/LongMenu';\nimport { Document, Page } from 'react-pdf';\nimport { pdfjs } from 'react-pdf';\nimport sample from '../../pdf-sample.pdf';\nimport FileOpen from './FileOpen'; //var fileDownload = require('js-file-download');\n\npdfjs.GlobalWorkerOptions.workerSrc = \"//cdnjs.cloudflare.com/ajax/libs/pdf.js/\".concat(pdfjs.version, \"/pdf.worker.js\");\n\nvar axios = require('axios');\n\nvar options = ['None', 'Atria', 'Callisto', 'Dione', 'Ganymede', 'Hangouts Call', 'Luna', 'Oberon', 'Phobos', 'Pyxis', 'Sedna', 'Titania', 'Triton', 'Umbriel'];\nvar ITEM_HEIGHT = 48;\n\nvar Files =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Files, _Component);\n\n  function Files(props) {\n    var _this;\n\n    _classCallCheck(this, Files);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Files).call(this, props));\n\n    _this.onDocumentLoadSuccess = function (_ref) {\n      var numPages = _ref.numPages;\n\n      _this.setState({\n        numPages: numPages\n      });\n    };\n\n    _this.fileChangedHandler = function (event) {\n      console.log(event.target.files[0]);\n\n      _this.setState({\n        selectedFile: event.target.files[0]\n      });\n\n      var name = event.target.files[0].name;\n      var size = event.target.files[0].size;\n      var formData = new FormData();\n      formData.append('myFile', event.target.files[0], event.target.files[0].name);\n      formData.append('courseid', localStorage.getItem(\"courseid\"));\n      axios.post('/upload', formData).then(function (res) {\n        console.log(res.status);\n\n        if (res.status === 200) {\n          var filearray = [].concat(_toConsumableArray(_this.state.files), [{\n            \"name\": name,\n            \"createdAt\": new Date(),\n            \"createdBy\": localStorage.getItem(\"username\"),\n            \"size\": size\n          }]);\n\n          _this.setState({\n            files: filearray\n          });\n        }\n      });\n    };\n\n    _this.handleMenuClick = function (event) {\n      _this.setState({\n        anchorEl: event.currentTarget\n      });\n    };\n\n    _this.handleMenuClose = function () {\n      _this.setState({\n        anchorEl: null\n      });\n    };\n\n    _this.handleOpenFile = function (fileid) {\n      axios.defaults.withCredentials = true;\n      console.log(fileid);\n      axios.get('/downloadfile', {\n        params: {\n          id: fileid\n        }\n      }).then(function (res) {\n        if (res.status === 200) {\n          console.log(res.data);\n          var preview = 'data:application/pdf;base64, ' + res.data;\n\n          _this.setState({\n            fileToOpen: preview,\n            open: true\n          });\n        }\n      });\n    };\n\n    _this.state = {\n      selectedFile: null,\n      fname: '',\n      show: '',\n      files: [],\n      anchorEl: '',\n      fileid: '',\n      data: '',\n      href: '',\n      numPages: null,\n      pageNumber: 1,\n      file: '',\n      term: '',\n      name: '',\n      nickname: '',\n      dept: '',\n      fileToOpen: '',\n      open: false //this.handleChange = this.handleChange.bind(this);\n\n    };\n    _this.handleclick = _this.handleclick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleMenuClick = _this.handleMenuClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleMenuClose = _this.handleMenuClose.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleOpenFile = _this.handleOpenFile.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.fileChangedHandler = _this.fileChangedHandler.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Files, [{\n    key: \"handleclick\",\n    value: function handleclick() {\n      this.setState(function (state) {\n        return {\n          show: !state.show\n        };\n      });\n    }\n  }, {\n    key: \"handleDelete\",\n    value: function handleDelete(id) {\n      var _this2 = this;\n\n      var fid = {\n        fileid: id\n      };\n      axios.defaults.withCredentials = true;\n      axios.post('/deleteFile', fid).then(function (res) {\n        if (res.status === 200) {\n          var file = _this2.state.files.filter(function (file) {\n            return file.fileid !== id;\n          });\n\n          _this2.setState({\n            files: file\n          });\n\n          console.log(_this2.state.files);\n        }\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      axios.defaults.withCredentials = true;\n      axios.get('/files', {\n        params: {\n          id: localStorage.getItem(\"courseid\")\n        }\n      }).then(function (res) {\n        if (res.status === 200) _this3.setState({\n          files: res.data\n        });\n      });\n      axios.get('/coursedetails', {\n        params: {\n          id: localStorage.getItem(\"courseid\")\n        }\n      }).then(function (res) {\n        if (res.status === 200) {\n          _this3.setState({\n            name: res.data.name,\n            term: res.data.term,\n            nickname: res.data.nickname,\n            dept: res.data.dept\n          });\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var redirectVar = null;\n      if (!cookie.load('cookie')) redirectVar = React.createElement(Redirect, {\n        to: \"/login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      });\n      var _this$state = this.state,\n          pageNumber = _this$state.pageNumber,\n          numPages = _this$state.numPages;\n      var data = Array.from(this.state.files).map(function (file, key) {\n        return React.createElement(\"tr\", {\n          key: key,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180\n          },\n          __self: this\n        }, React.createElement(\"a\", {\n          onClick: function onClick() {\n            return _this4.handleOpenFile(file.fileid);\n          },\n          download: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180\n          },\n          __self: this\n        }, file.name)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        }, \" \", React.createElement(Moment, {\n          format: \"ll\",\n          date: new Date(file.createdAt),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        }), \" \"), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182\n          },\n          __self: this\n        }, file.size), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183\n          },\n          __self: this\n        }, file.createdBy), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184\n          },\n          __self: this\n        }, localStorage.getItem(\"role\") === 'Teacher' && React.createElement(LongMenu, {\n          delete: function _delete() {\n            return _this4.handleDelete(file.fileid);\n          },\n          edit: function edit() {\n            return _this4.handleEdit(file.fileid);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184\n          },\n          __self: this\n        })));\n      });\n      var anchorEl = this.state.anchorEl;\n      var open = Boolean(anchorEl);\n      if (this.state.fileToOpen) return React.createElement(FileOpen, {\n        fileToOpen: this.state.fileToOpen,\n        name: this.state.name,\n        dept: this.state.dept,\n        nickname: this.state.nickname,\n        term: this.state.term,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      });else {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 194\n          },\n          __self: this\n        }, redirectVar, React.createElement(Appbar, {\n          name: this.state.name,\n          dept: this.state.dept,\n          nickname: this.state.nickname,\n          term: this.state.term,\n          tag: \"Files\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195\n          },\n          __self: this\n        }), React.createElement(Grid, {\n          container: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, React.createElement(Grid, {\n          item: true,\n          xs: 0.5,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198\n          },\n          __self: this\n        }, React.createElement(MiniDrawer, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199\n          },\n          __self: this\n        })), React.createElement(Grid, {\n          item: true,\n          xs: 1.5,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201\n          },\n          __self: this\n        }, React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201\n          },\n          __self: this\n        }), React.createElement(MenuList, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        })), React.createElement(Grid, {\n          item: true,\n          xs: 8,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 205\n          },\n          __self: this\n        }, React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }), \" \", React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }), React.createElement(Container, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 207\n          },\n          __self: this\n        }, React.createElement(Row, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208\n          },\n          __self: this\n        }, React.createElement(Col, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 209\n          },\n          __self: this\n        }, React.createElement(Search, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 209\n          },\n          __self: this\n        })), React.createElement(Col, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 210\n          },\n          __self: this\n        }, localStorage.getItem(\"role\") === 'Teacher' && React.createElement(\"input\", {\n          type: \"file\",\n          name: \"Upload\",\n          onChange: this.fileChangedHandler,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 210\n          },\n          __self: this\n        })), React.createElement(Col, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 211\n          },\n          __self: this\n        })))), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }, React.createElement(\"table\", {\n          cellpadding: \"0\",\n          cellspacing: \"0\",\n          className: \"table\",\n          cellSpacing: \"1\",\n          style: {\n            marginLeft: 20,\n            paddingTop: 0\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216\n          },\n          __self: this\n        }, React.createElement(\"tr\", {\n          style: {\n            color: \"#094D98\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218\n          },\n          __self: this\n        }, \"File Name\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219\n          },\n          __self: this\n        }, \"Date Created\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }, \"Size(KB)\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }, \"Created By\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        })), React.createElement(\"tbody\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224\n          },\n          __self: this\n        }, data), React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }))))), React.createElement(Grid, {\n          item: true,\n          xs: 1,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 231\n          },\n          __self: this\n        }, React.createElement(Sidebar, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        }))));\n      }\n    }\n  }]);\n\n  return Files;\n}(Component);\n\nexport default Files; //","map":{"version":3,"sources":["/Users/supriyajain/Desktop/273/canvas/Lab1 - 013767416/canvas/frontend/src/components/CourseDetails/Files/Files.js"],"names":["React","Component","FormData","FaTrash","Grid","MiniDrawer","Sidebar","Appbar","MenuList","Container","Row","Col","Search","Moment","cookie","Redirect","LongMenu","Document","Page","pdfjs","sample","FileOpen","GlobalWorkerOptions","workerSrc","version","axios","require","options","ITEM_HEIGHT","Files","props","onDocumentLoadSuccess","numPages","setState","fileChangedHandler","event","console","log","target","files","selectedFile","name","size","formData","append","localStorage","getItem","post","then","res","status","filearray","state","Date","handleMenuClick","anchorEl","currentTarget","handleMenuClose","handleOpenFile","fileid","defaults","withCredentials","get","params","id","data","preview","fileToOpen","open","fname","show","href","pageNumber","file","term","nickname","dept","handleclick","bind","fid","filter","redirectVar","load","Array","from","map","key","createdAt","createdBy","handleDelete","handleEdit","Boolean","marginLeft","paddingTop","color"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport \"react-web-tabs/dist/react-web-tabs.css\";\nimport FormData from 'form-data';\nimport { FaTrash } from \"react-icons/fa\";\nimport Grid from '@material-ui/core/Grid';\nimport MiniDrawer from '../../Layout/MiniDrawer';\nimport Sidebar from '../../Layout/Sidebar';\nimport Appbar from '../../Layout/Appbar';\nimport MenuList from '../../Layout/MenuList';\nimport { Container, Row, Col } from 'reactstrap';\nimport Search from '../../Search';\nimport Moment from 'react-moment';\nimport cookie from 'react-cookies';\nimport {Redirect} from 'react-router';\nimport LongMenu from '../../Layout/LongMenu';\nimport {Document, Page} from 'react-pdf';\nimport {pdfjs} from 'react-pdf';\nimport sample from '../../pdf-sample.pdf';\nimport FileOpen from './FileOpen';\n//var fileDownload = require('js-file-download');\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\n\nconst axios = require('axios');\nconst options = [\n  'None',\n  'Atria',\n  'Callisto',\n  'Dione',\n  'Ganymede',\n  'Hangouts Call',\n  'Luna',\n  'Oberon',\n  'Phobos',\n  'Pyxis',\n  'Sedna',\n  'Titania',\n  'Triton',\n  'Umbriel',\n];\nconst ITEM_HEIGHT = 48;\n\nclass Files extends Component \n{\n    constructor(props)\n    {\n        super(props);\n        this.state = { selectedFile: null,\n        fname : '' ,\n        show:'',\n        files : [],\n        anchorEl: '',\n        fileid:'',\n        data :'',\n        href:'',\n        numPages: null,\n        pageNumber: 1,\n        file:'',\n        term:'',\n        name:'',\n        nickname:'',\n        dept:'',\n        fileToOpen:'',\n        open:false,\n     \n      }\n        //this.handleChange = this.handleChange.bind(this);\n        this.handleclick = this.handleclick.bind(this);\n        this.handleMenuClick = this.handleMenuClick.bind(this);\n        this.handleMenuClose=this.handleMenuClose.bind(this);\n        this.handleOpenFile=this.handleOpenFile.bind(this);\n        this.fileChangedHandler= this.fileChangedHandler.bind(this);\n    }\n    onDocumentLoadSuccess = ({ numPages }) => {\n      this.setState({ numPages });\n    }\n    fileChangedHandler = event => {\n      console.log(event.target.files[0] );\n      this.setState({ selectedFile: event.target.files[0] });\n      var name = event.target.files[0].name;\n      var size = event.target.files[0].size;\n      const formData = new FormData();\n      formData.append(\n        'myFile',\n        event.target.files[0],\n        event.target.files[0].name,\n      );\n      formData.append('courseid', localStorage.getItem(\"courseid\"));\n      axios.post('/upload', formData).\n      then(res=>{\n        console.log(res.status);\n        if(res.status === 200)\n          {\n            let filearray = [...this.state.files, {\"name\": name , \"createdAt\": new Date(), \"createdBy\":localStorage.getItem(\"username\"), \"size\": size}];\n            this.setState({files : filearray});\n          }\n      });\n    }\n    handleclick(){\n      this.setState(state => ({\n        show: !state.show\n      }));      \n    }\n    handleMenuClick = event => {\n      this.setState({ anchorEl: event.currentTarget });\n    };\n\n    handleMenuClose = () => {\n      this.setState({ anchorEl: null });\n    };\n  \n    handleDelete(id){\n      const fid ={\n        fileid : id\n      }  \n      axios.defaults.withCredentials = true;  \n      axios.post('/deleteFile', fid ).then(\n        res => {\n          if(res.status ===200)\n             {\n              let file = this.state.files.filter(file => {\n              return file.fileid !== id });\n              this.setState({files:file});\n              console.log(this.state.files)\n             }\n        }\n      )\n    }\n    handleOpenFile = (fileid) => \n    {\n      axios.defaults.withCredentials = true;\n      console.log(fileid)\n      axios.get('/downloadfile',  {params : {id :fileid}}).then(\n        res => {\n          if(res.status ===200)\n            {\n              console.log(res.data);\n              let preview = 'data:application/pdf;base64, ' + res.data;\n              this.setState({\n                fileToOpen: preview,\n                open:true})\n            }\n        }\n      )   \n   };\n    componentDidMount()\n    {\n      axios.defaults.withCredentials = true;\n      axios.get('/files', {params : {id :localStorage.getItem(\"courseid\")}} ).then(\n        res => {\n          if(res.status ===200)\n              this.setState({files: res.data});\n        }\n      )\n      axios.get('/coursedetails', {params : {id :localStorage.getItem(\"courseid\")}}  ).then(\n        res => {\n          if(res.status ===200)\n          {\n              this.setState(\n                {\n                  name:res.data.name,\n                  term:res.data.term,\n                  nickname:res.data.nickname,\n                  dept:res.data.dept\n                });     \n          }    \n        }\n      )\n    }\n\n  render() {\n    let redirectVar = null;\n    if(!cookie.load('cookie'))\n        redirectVar = <Redirect to= \"/login\"/>\n \n\n    const { pageNumber, numPages } = this.state;\n    var data =  Array.from(this.state.files).map((file, key) => {\n    return (\n      <tr key = {key} >                   \n      <td ><a onClick={() =>this.handleOpenFile(file.fileid)} download>{file.name}</a></td>\n      <td> <Moment format=\"ll\" date={new Date(file.createdAt)}/> </td>\n      <td>{file.size}</td>\n      <td>{file.createdBy}</td>\n    <td>{ localStorage.getItem(\"role\")==='Teacher' && <LongMenu delete={() =>this.handleDelete(file.fileid)} edit={() =>this.handleEdit(file.fileid)}/>}</td>\n      </tr>\n    )\n    });\n    const { anchorEl } = this.state;\n    const open = Boolean(anchorEl);\n    if(this.state.fileToOpen)\n    return (<FileOpen fileToOpen= {this.state.fileToOpen} name={this.state.name} dept={this.state.dept} nickname={this.state.nickname} term ={this.state.term}/>)\n    else {\n      return (\n      <div>{redirectVar}\n      <Appbar name={this.state.name}  dept={this.state.dept}  nickname={this.state.nickname}  term={this.state.term}\n      tag=\"Files\" />\n      <Grid container>   \n        <Grid item xs={0.5}>\n          <MiniDrawer/>\n        </Grid>  \n        <Grid item xs={1.5}><br/>\n          <MenuList />\n        </Grid>                  \n      <Grid item xs={8}>\n      <div >\n       <br/><br/><br/> <br/><br/>\n        <Container>\n        <Row>\n        <Col><Search/></Col>\n    <Col>{ localStorage.getItem(\"role\")==='Teacher' && <input type=\"file\" name=\"Upload\" onChange={this.fileChangedHandler} />}</Col>\n        <Col></Col>\n        </Row>\n        </Container>         \n        </div>\n      <div>\n          <table  cellpadding=\"0\" cellspacing=\"0\" className=\"table\"  cellSpacing=\"1\" style= {{marginLeft:20 , paddingTop: 0 }}>\n              <tr style={{color: \"#094D98\"}}>\n              <th>File Name</th>\n              <th>Date Created</th>\n              <th>Size(KB)</th>\n              <th>Created By</th>\n              <th></th>\n              </tr>\n            <tbody>{data}</tbody>\n            <tr><td></td><td></td><td></td><td></td><td></td></tr>\n            </table>   \n\n          </div>\n          </Grid>\n\n          <Grid item xs={1}>\n           <Sidebar/>\n           </Grid>\n      </Grid>\n\n      </div>\n    \n      \n      \n\n    )\n      }\n  }\n}\n \nexport default Files;\n\n// \n\n"]},"metadata":{},"sourceType":"module"}