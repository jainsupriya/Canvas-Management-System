{"ast":null,"code":"import _defineProperty from \"/Users/supriyajain/Desktop/273/canvas/tmp_CMPE273-SP19-18/CMPE273-SP19-18/Lab3 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/supriyajain/Desktop/273/canvas/tmp_CMPE273-SP19-18/CMPE273-SP19-18/Lab3 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/supriyajain/Desktop/273/canvas/tmp_CMPE273-SP19-18/CMPE273-SP19-18/Lab3 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/supriyajain/Desktop/273/canvas/tmp_CMPE273-SP19-18/CMPE273-SP19-18/Lab3 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/supriyajain/Desktop/273/canvas/tmp_CMPE273-SP19-18/CMPE273-SP19-18/Lab3 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/supriyajain/Desktop/273/canvas/tmp_CMPE273-SP19-18/CMPE273-SP19-18/Lab3 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/supriyajain/Desktop/273/canvas/tmp_CMPE273-SP19-18/CMPE273-SP19-18/Lab3 - 013767416/canvas/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/supriyajain/Desktop/273/canvas/tmp_CMPE273-SP19-18/CMPE273-SP19-18/Lab3 - 013767416/canvas/frontend/src/components/CourseDetails/Files/Files.js\";\nimport React, { Component } from 'react';\nimport \"react-web-tabs/dist/react-web-tabs.css\";\nimport FormData from 'form-data';\nimport Grid from '@material-ui/core/Grid';\nimport MiniDrawer from '../../Layout/MiniDrawer';\nimport Sidebar from '../../Layout/Sidebar';\nimport Appbar from '../../Layout/Appbar';\nimport MenuList from '../../Layout/MenuList';\nimport { Container, Row, Col } from 'reactstrap';\nimport Search from '../../Search';\nimport Moment from 'react-moment';\nimport { Redirect } from 'react-router';\nimport LongMenu from '../../Layout/LongMenu';\nimport { pdfjs } from 'react-pdf';\nimport FileOpen from './FileOpen';\nimport { getFiles } from \"../../../actions\";\nimport { createFile } from \"../../../actions\";\nimport { connect } from 'react-redux'; //var fileDownload = require('js-file-download');\n\npdfjs.GlobalWorkerOptions.workerSrc = \"//cdnjs.cloudflare.com/ajax/libs/pdf.js/\".concat(pdfjs.version, \"/pdf.worker.js\");\n\nvar axios = require('axios');\n\nvar Files =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Files, _Component);\n\n  function Files(props) {\n    var _this$state;\n\n    var _this;\n\n    _classCallCheck(this, Files);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Files).call(this, props));\n\n    _this.onDocumentLoadSuccess = function (_ref) {\n      var numPages = _ref.numPages;\n\n      _this.setState({\n        numPages: numPages\n      });\n    };\n\n    _this.fileChangedHandler = function (event) {\n      console.log(event.target.files[0]);\n\n      _this.setState({\n        selectedFile: event.target.files[0]\n      });\n\n      var formData = new FormData();\n      formData.append('myFile', event.target.files[0], event.target.files[0].name);\n      formData.append('courseid', localStorage.getItem(\"courseid\"));\n\n      _this.props.createFile(formData); //let filearray = [...this.state.files, {\"Name\": name , \"createdAt\": new Date(), \"createdBy\":localStorage.getItem(\"username\"), \"Size\": size}];\n      //this.setState({files : filearray});\n\n    };\n\n    _this.handleMenuClick = function (event) {\n      _this.setState({\n        anchorEl: event.currentTarget\n      });\n    };\n\n    _this.handleMenuClose = function () {\n      _this.setState({\n        anchorEl: null\n      });\n    };\n\n    _this.handleOpenFile = function (fileid) {\n      axios.defaults.withCredentials = true;\n\n      var file = _this.state.files.filter(function (file) {\n        return file._id === fileid;\n      });\n\n      var filename = file[0].Name;\n      var type = file[0].Type;\n      axios.get('/file/downloadfile', {\n        params: {\n          name: filename,\n          type: type\n        }\n      }).then(function (res) {\n        if (res.status === 200) {\n          console.log(res.data);\n          var preview = 'data:application/pdf;base64, ' + res.data;\n\n          _this.setState({\n            fileToOpen: preview,\n            open: true\n          });\n        }\n      });\n    };\n\n    _this.state = (_this$state = {\n      selectedFile: null,\n      fname: '',\n      show: '',\n      files: [],\n      anchorEl: '',\n      fileid: '',\n      data: '',\n      href: '',\n      numPages: null,\n      pageNumber: 1,\n      file: '',\n      course: ''\n    }, _defineProperty(_this$state, \"course\", []), _defineProperty(_this$state, \"fileToOpen\", ''), _defineProperty(_this$state, \"open\", false), _this$state); //this.handleChange = this.handleChange.bind(this);\n\n    _this.handleclick = _this.handleclick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleMenuClick = _this.handleMenuClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleMenuClose = _this.handleMenuClose.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleOpenFile = _this.handleOpenFile.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.fileChangedHandler = _this.fileChangedHandler.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Files, [{\n    key: \"handleclick\",\n    value: function handleclick() {\n      this.setState(function (state) {\n        return {\n          show: !state.show\n        };\n      });\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var coursearray = this.props.courseStore.result;\n      var courseid = localStorage.getItem(\"courseid\");\n\n      if (coursearray) {\n        var coursedetail = coursearray.filter(function (course) {\n          return course._id === courseid;\n        });\n        this.setState({\n          course: coursedetail[0]\n        });\n      }\n\n      this.props.getFiles();\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.files) {\n        this.setState({\n          files: nextProps.files.files\n        });\n      }\n    }\n  }, {\n    key: \"handleDelete\",\n    value: function handleDelete(id) {\n      var _this2 = this;\n\n      var fid = {\n        fileid: id\n      };\n      axios.defaults.withCredentials = true;\n      axios.post('/deleteFile', fid).then(function (res) {\n        if (res.status === 200) {\n          var file = _this2.state.files.filter(function (file) {\n            return file.fileid !== id;\n          });\n\n          _this2.setState({\n            files: file\n          });\n\n          console.log(_this2.state.files);\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var redirectVar = null;\n      if (!this.props.loginstatus.loginstatus) redirectVar = React.createElement(Redirect, {\n        to: \"/login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      });\n      var data = Array.from(this.state.files).map(function (file, key) {\n        return React.createElement(\"tr\", {\n          key: key,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, React.createElement(\"a\", {\n          onClick: function onClick() {\n            return _this3.handleOpenFile(file._id);\n          },\n          download: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, file.Name)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }, \" \", React.createElement(Moment, {\n          format: \"ll\",\n          date: new Date(file.CreatedAt),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }), \" \"), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, file.Size), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, file.CreatedBy), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, localStorage.getItem(\"role\") === 'Teacher' && React.createElement(LongMenu, {\n          delete: function _delete() {\n            return _this3.handleDelete(file._id);\n          },\n          edit: function edit() {\n            return _this3.handleEdit(file._id);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        })));\n      });\n      var anchorEl = this.state.anchorEl;\n      var open = Boolean(anchorEl);\n      if (this.state.fileToOpen) return React.createElement(FileOpen, {\n        fileToOpen: this.state.fileToOpen,\n        name: this.state.name,\n        dept: this.state.dept,\n        nickname: this.state.nickname,\n        term: this.state.term,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      });else {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166\n          },\n          __self: this\n        }, redirectVar, React.createElement(Appbar, {\n          name: this.state.course.Name,\n          dept: this.state.course.Dept,\n          nickname: this.state.course.Nickname,\n          term: this.state.course.Term,\n          tag: \"Files\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          },\n          __self: this\n        }), React.createElement(Grid, {\n          container: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169\n          },\n          __self: this\n        }, React.createElement(Grid, {\n          item: true,\n          xs: 0.5,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170\n          },\n          __self: this\n        }, React.createElement(MiniDrawer, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        })), React.createElement(Grid, {\n          item: true,\n          xs: 1.5,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        }, React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        }), React.createElement(MenuList, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174\n          },\n          __self: this\n        })), React.createElement(Grid, {\n          item: true,\n          xs: 8,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177\n          },\n          __self: this\n        }, React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        }), \" \", React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        }), React.createElement(Container, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179\n          },\n          __self: this\n        }, React.createElement(Row, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180\n          },\n          __self: this\n        }, React.createElement(Col, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        }, React.createElement(Search, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        })), React.createElement(Col, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182\n          },\n          __self: this\n        }, localStorage.getItem(\"role\") === 'Teacher' && React.createElement(\"input\", {\n          type: \"file\",\n          name: \"Upload\",\n          onChange: this.fileChangedHandler,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182\n          },\n          __self: this\n        })), React.createElement(Col, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183\n          },\n          __self: this\n        })))), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187\n          },\n          __self: this\n        }, React.createElement(\"table\", {\n          cellpadding: \"0\",\n          cellspacing: \"0\",\n          className: \"table\",\n          cellSpacing: \"1\",\n          style: {\n            marginLeft: 20,\n            paddingTop: 0\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188\n          },\n          __self: this\n        }, React.createElement(\"tr\", {\n          style: {\n            color: \"#094D98\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190\n          },\n          __self: this\n        }, \"File Name\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191\n          },\n          __self: this\n        }, \"Date Created\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        }, \"Size(KB)\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        }, \"Created By\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 194\n          },\n          __self: this\n        })), React.createElement(\"tbody\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196\n          },\n          __self: this\n        }, data), React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }))))), React.createElement(Grid, {\n          item: true,\n          xs: 1,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 203\n          },\n          __self: this\n        }, React.createElement(Sidebar, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204\n          },\n          __self: this\n        }))));\n      }\n    }\n  }]);\n\n  return Files;\n}(Component);\n\nfunction mapStateToProps(state) {\n  return {\n    files: state.files,\n    courseStore: state.courses,\n    loginstatus: state.loginstatus\n  };\n}\n\nexport default connect(mapStateToProps, {\n  getFiles: getFiles,\n  createFile: createFile\n})(Files); //","map":{"version":3,"sources":["/Users/supriyajain/Desktop/273/canvas/tmp_CMPE273-SP19-18/CMPE273-SP19-18/Lab3 - 013767416/canvas/frontend/src/components/CourseDetails/Files/Files.js"],"names":["React","Component","FormData","Grid","MiniDrawer","Sidebar","Appbar","MenuList","Container","Row","Col","Search","Moment","Redirect","LongMenu","pdfjs","FileOpen","getFiles","createFile","connect","GlobalWorkerOptions","workerSrc","version","axios","require","Files","props","onDocumentLoadSuccess","numPages","setState","fileChangedHandler","event","console","log","target","files","selectedFile","formData","append","name","localStorage","getItem","handleMenuClick","anchorEl","currentTarget","handleMenuClose","handleOpenFile","fileid","defaults","withCredentials","file","state","filter","_id","filename","Name","type","Type","get","params","then","res","status","data","preview","fileToOpen","open","fname","show","href","pageNumber","course","handleclick","bind","coursearray","courseStore","result","courseid","coursedetail","nextProps","id","fid","post","redirectVar","loginstatus","Array","from","map","key","Date","CreatedAt","Size","CreatedBy","handleDelete","handleEdit","Boolean","dept","nickname","term","Dept","Nickname","Term","marginLeft","paddingTop","color","mapStateToProps","courses"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport \"react-web-tabs/dist/react-web-tabs.css\";\r\nimport FormData from 'form-data';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport MiniDrawer from '../../Layout/MiniDrawer';\r\nimport Sidebar from '../../Layout/Sidebar';\r\nimport Appbar from '../../Layout/Appbar';\r\nimport MenuList from '../../Layout/MenuList';\r\nimport { Container, Row, Col } from 'reactstrap';\r\nimport Search from '../../Search';\r\nimport Moment from 'react-moment';\r\nimport {Redirect} from 'react-router';\r\nimport LongMenu from '../../Layout/LongMenu';\r\nimport {pdfjs} from 'react-pdf';\r\nimport FileOpen from './FileOpen';\r\nimport { getFiles } from \"../../../actions\";\r\nimport { createFile } from \"../../../actions\";\r\nimport { connect } from 'react-redux';\r\n//var fileDownload = require('js-file-download');\r\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\r\n\r\nconst axios = require('axios');\r\n\r\nclass Files extends Component \r\n{\r\n    constructor(props)\r\n    {\r\n        super(props);\r\n        this.state = { selectedFile: null,\r\n        fname : '' ,\r\n        show:'',\r\n        files : [],\r\n        anchorEl: '',\r\n        fileid:'',\r\n        data :'',\r\n        href:'',\r\n        numPages: null,\r\n        pageNumber: 1,\r\n        file:'',\r\n        course:'',\r\n        course:[],\r\n        fileToOpen:'',\r\n        open:false,\r\n     \r\n      }\r\n        //this.handleChange = this.handleChange.bind(this);\r\n        this.handleclick = this.handleclick.bind(this);\r\n        this.handleMenuClick = this.handleMenuClick.bind(this);\r\n        this.handleMenuClose=this.handleMenuClose.bind(this);\r\n        this.handleOpenFile=this.handleOpenFile.bind(this);\r\n        this.fileChangedHandler= this.fileChangedHandler.bind(this);\r\n    }\r\n    onDocumentLoadSuccess = ({ numPages }) => {\r\n      this.setState({ numPages });\r\n    }\r\n    fileChangedHandler = event => {\r\n      console.log(event.target.files[0] );\r\n      this.setState({ selectedFile: event.target.files[0] });\r\n      const formData = new FormData();\r\n      formData.append(\r\n        'myFile',\r\n        event.target.files[0],\r\n        event.target.files[0].name,\r\n      );\r\n      formData.append('courseid', localStorage.getItem(\"courseid\"));\r\n      this.props.createFile(formData);\r\n\r\n      //let filearray = [...this.state.files, {\"Name\": name , \"createdAt\": new Date(), \"createdBy\":localStorage.getItem(\"username\"), \"Size\": size}];\r\n      //this.setState({files : filearray});\r\n    }\r\n    handleclick(){\r\n      this.setState(state => ({\r\n        show: !state.show\r\n      }));      \r\n    }\r\n    handleMenuClick = event => {\r\n      this.setState({ anchorEl: event.currentTarget });\r\n    };\r\n\r\n    handleMenuClose = () => {\r\n      this.setState({ anchorEl: null });\r\n    };\r\n    componentWillMount()\r\n    { \r\n      var coursearray = this.props.courseStore.result;\r\n      var courseid = localStorage.getItem(\"courseid\");\r\n      if(coursearray)\r\n      {\r\n        let coursedetail = coursearray.filter(course => {\r\n          return course._id === courseid });\r\n        this.setState({course:coursedetail[0]});\r\n      }\r\n      this.props.getFiles();\r\n    }\r\n  \r\n    componentWillReceiveProps(nextProps) {\r\n    \r\n      if (nextProps.files) {\r\n          this.setState({\r\n            files: nextProps.files.files\r\n          });\r\n      }  \r\n    } \r\n    handleDelete(id){\r\n      const fid ={\r\n        fileid : id\r\n      }  \r\n      axios.defaults.withCredentials = true;  \r\n      axios.post('/deleteFile', fid ).then(\r\n        res => {\r\n          if(res.status ===200)\r\n             {\r\n              let file = this.state.files.filter(file => {\r\n              return file.fileid !== id });\r\n              this.setState({files:file});\r\n              console.log(this.state.files)\r\n             }\r\n        }\r\n      )\r\n    }\r\n    handleOpenFile = (fileid) => \r\n    {\r\n      axios.defaults.withCredentials = true;\r\n      let file = this.state.files.filter(file => {\r\n        return file._id === fileid });\r\n     var filename = file[0].Name;\r\n     var type = file[0].Type;\r\n      axios.get('/file/downloadfile',  {params : {name :filename, type: type}}).then(\r\n        res => {\r\n          if(res.status ===200)\r\n            {\r\n              console.log(res.data);\r\n              let preview = 'data:application/pdf;base64, ' + res.data;\r\n              this.setState({\r\n                fileToOpen: preview,\r\n                open:true})\r\n            }\r\n        }\r\n      )   \r\n   };\r\n\r\n\r\n  render() \r\n  {\r\n    let redirectVar = null;\r\n    if(!this.props.loginstatus.loginstatus) \r\n      redirectVar = <Redirect to= \"/login\"/>\r\n \r\n    var data =  Array.from(this.state.files).map((file, key) => {\r\n    return (\r\n      <tr key = {key} >                   \r\n      <td ><a onClick={() =>this.handleOpenFile(file._id)} download>{file.Name}</a></td>\r\n      <td> <Moment format=\"ll\" date={new Date(file.CreatedAt)}/> </td>\r\n      <td>{file.Size}</td>\r\n      <td>{file.CreatedBy}</td>\r\n      <td>{ localStorage.getItem(\"role\")==='Teacher' && <LongMenu delete={() =>this.handleDelete(file._id)} edit={() =>this.handleEdit(file._id)}/>}</td>\r\n      </tr>\r\n    )\r\n    });\r\n    const { anchorEl } = this.state;\r\n    const open = Boolean(anchorEl);\r\n    if(this.state.fileToOpen)\r\n    return (<FileOpen fileToOpen= {this.state.fileToOpen} name={this.state.name} dept={this.state.dept} nickname={this.state.nickname} term ={this.state.term}/>)\r\n    else {\r\n      return (\r\n      <div>{redirectVar}\r\n      <Appbar name={this.state.course.Name}  dept={this.state.course.Dept}  nickname={this.state.course.Nickname}  term={this.state.course.Term}\r\n      tag=\"Files\" />\r\n      <Grid container>   \r\n        <Grid item xs={0.5}>\r\n          <MiniDrawer/>\r\n        </Grid>  \r\n        <Grid item xs={1.5}><br/>\r\n          <MenuList />\r\n        </Grid>                  \r\n      <Grid item xs={8}>\r\n      <div >\r\n       <br/><br/><br/> <br/><br/>\r\n        <Container>\r\n        <Row>\r\n        <Col><Search/></Col>\r\n    <Col>{ localStorage.getItem(\"role\")==='Teacher' && <input type=\"file\" name=\"Upload\" onChange={this.fileChangedHandler} />}</Col>\r\n        <Col></Col>\r\n        </Row>\r\n        </Container>         \r\n        </div>\r\n      <div>\r\n          <table  cellpadding=\"0\" cellspacing=\"0\" className=\"table\"  cellSpacing=\"1\" style= {{marginLeft:20 , paddingTop: 0 }}>\r\n              <tr style={{color: \"#094D98\"}}>\r\n              <th>File Name</th>\r\n              <th>Date Created</th>\r\n              <th>Size(KB)</th>\r\n              <th>Created By</th>\r\n              <th></th>\r\n              </tr>\r\n            <tbody>{data}</tbody>\r\n            <tr><td></td><td></td><td></td><td></td><td></td></tr>\r\n            </table>   \r\n\r\n          </div>\r\n          </Grid>\r\n\r\n          <Grid item xs={1}>\r\n           <Sidebar/>\r\n           </Grid>\r\n      </Grid>\r\n\r\n      </div>\r\n    \r\n      \r\n      \r\n\r\n    )\r\n      }\r\n  }\r\n}\r\nfunction mapStateToProps(state) {\r\n  return { files: state.files ,\r\n    courseStore: state.courses ,\r\n    loginstatus: state.loginstatus};\r\n}\r\n      \r\n\r\nexport default connect(mapStateToProps,{ getFiles, createFile })(Files);\r\n// \r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}